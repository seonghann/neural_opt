# config file for load dataset
# train contains batch_size, num_workers

train:
  batch_size: 64
  num_workers: 4
  lambda_train: 0.01
  lambda_valid: 0.01
  clip_grad: null  # float, null to disable
  progress_bar: False
  weight_decay: 1e-12
  optimizer: adamw
  seed: 1994
  lr: 0.001
  epochs: 10

  check_val_every_n_epoch: 1
  sample_every_n_batch: 10
  sample_every_n_valid: 10

dataset:
  name: Geodesic2DFT
  datadir: 'data'
  raw_datadir: 'data/raw/GeodesictoDFT'

debug:
  save_dir: './debug'

general:
  name: 'second'
  # name: 'debug'
  use_wandb: False
  wandb: 'online'
  save_model: True
  gpus: 4
  strategy: 'deepspeed'  # auto, ddp, fsdp, deepspeed,
  resume: # ckpt path
  test_only: # ckpt path

sampling:
  sde_dt: 0.05
  gode_iter: 50
  gode_ref_dt: 0.05
  gode_max_dt: 0.1

model:
  hidden_dim: 128
  num_bond_type: 10
  num_atom_type: 4
  num_atom_feat: 8
  score_act: 'silu'
  edge_cat_act: 'silu'
  edge_encoder:
    name: 'mlp'
    activation: 'silu'
  graph_encoder:
    name: 'schnet'
    node_dim: 128
    time_dim: 256
    edge_dim: 128
    num_filters: 128
    num_convs: 6
    cutoff: 15.0
    smooth_conv: False

diffusion:
  scheduler:
    name: 'bellcurve'
    sigma_min: 1e-07
    sigma_max: 0.001
    beta_std: 0.125

manifold:
  ode_solver:
    vpae_thresh: 0.03  # percent error threshold
    alpha: 1.6
    beta: 2.3
    svd_tol: 1e-6
    iter: 10
    max_iter: 1000
    ref_dt: 5e-2
    _ref_dt: 5e-3
    max_dt: 1e-1
    _max_dt: 5e-2
    min_dt: 1e-3
    _min_dt: 1e-4
    pos_adjust_scaler: 0.03
    pos_adjust_thresh: 3e-3
